<?php

require_once('config.php');
$class_path = $project_classes_dir . '/' . 'MalwareDetector.inc.php';
require_once($class_path);

class MalwareDbTest extends PHPUnit_Framework_TestCase {

    public function testRegExpSyntax() {
       global $class_path;

       $snippet = '';
       $pos = '';

       ob_clean();
       ob_start();
       // this will validate schema
       $detector = new MalwareDetector();
       // this will check syntax
       $timeout = 20;
       $res = $detector->detectMalware($class_path, $snippet, $pos, 0, $timeout);
       $output = ob_get_contents();
       ob_end_clean();

       // any errors?
       $this->assertEquals(strlen($output), 0);

    }

}

?>