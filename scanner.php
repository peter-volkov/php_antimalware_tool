<?php

ob_start();
require_once("classes/FileInfo.php.inc");
require_once("classes/WebServerEnvInfo.php.inc");
require_once("classes/FileSystemSnapshot.php.inc");
require_once("classes/View.php.inc");
ob_end_clean();


$ws_env = new WebServerEnvInfo();
$ws_env_node = $ws_env->getXMLNode();

$fs = new FileSystemSnapshot();
$fs->takeSnapshot();
$fs_node = $fs->getXMLNode();

$dom = new DOMDocument("1.0", "utf-8");
$dom->formatOutput = true;

$website_info_node = $dom->createElement("website_info");
$dom->appendChild($website_info_node);

$dom->documentElement->appendChild($dom->importNode($ws_env_node, true));
$dom->documentElement->appendChild($dom->importNode($fs_node, true));

$xml = $dom->saveXML();

function template_output($xml) {
    $view = new View("/templates/");
    $view->set("title", "Result");
    $view->set("xml_log", htmlentities($xml));
    $view->display("scanner.tpl");
}

function raw_xml_output($xml) {
    Header("Content-type: text/xml");		
    print $xml;
}

template_output($xml);


?>


